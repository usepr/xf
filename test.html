<html>
  <head>
  <meta http-equiv="cache-control" content="no-cache">
  </head>
	
	<button onclick='base64_test()'>--------base64 test--------</button>
	<br/>
	<button onclick='string_test()'>--------string test--------</button>
	<br/>
	<button onclick='splitloc_test()'>--------split location test--------</button>
	<br/>
	<button onclick='loc_test()'>--------location test--------</button>
	<br/>
	<button onclick='nohref_test()'>--------non-href test--------</button>
	<br/>
	<button onclick='assign_test()'>--------assign test--------</button>
	<br/>
	<button onclick='open_test()'>--------open test--------</button>
	<br/>
	<button onclick='domain_test()'>--------domain test--------</button>
	
<script>
	function base64_test(){
		var url = window.atob("eHh4aHR0cDovL3d3dy5iYWlkdS5jb20=").substr(3); // http://www.baidu.com
		window.location.href = url;
	}
	
	function concat_test(){
		var t = "tp:/";
		t += "/www.bai";
		t += "du.co";
		
		var s = window.location;
		var ss = location;
		var u = 'hr';
		s[u+'ef'] = "ht" + t + "m";
	}
	
	function string_test(){
		window['location'].href = "http://baidu.com";
	}
	function splitloc_test(){
		window['loca' + 'tion'].href = "http://baidu.com";
	}
	function nohref_test(){
		location = "http://baidu.com";
	}
	function assign_test(){
		location.assign("http://baidu.com");
	}
	function open_test(){
		window.open("http://baidu.com");
	}
	function domain_test(){
		document.domain = "http://baidu.com";
		console.log(document.domain);
	}
		
if (!Object.prototype.watch) {
	Object.defineProperty(Object.prototype, "watch", {
		enumerable: false
		, configurable: true
		, writable: false
		, value: function (prop, handler) {
			var
			oldval = this[prop]
			, newval = oldval
			, getter = function () {
				return newval;
			}
			, setter = function (val) {
				oldval = newval;
				return newval = handler.call(this, prop, oldval, val);
			}
			;

			if (delete this[prop]) { // can't watch constants
				Object.defineProperty(this, prop, {
					get: getter
					, set: setter
					, enumerable: true
					, configurable: true
				});
			}
		}
	});
}
var ff = document.__proto__.__lookupSetter__('domain');
HTMLDocument.prototype.__defineSetter__("domain",function (url){
	 url = 'github.' + url;
	 console.log(url);
	 ff.apply(this, arguments);
});
document.domain = '.com';
console.log(document.domain);
</script>
	
</html>
